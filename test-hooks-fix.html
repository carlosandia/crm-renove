<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Fix React Hooks</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            margin: 20px;
            background: #f3f4f6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .status {
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 16px;
        }
        .success { background: #d1fae5; color: #065f46; }
        .error { background: #fee2e2; color: #991b1b; }
        .info { background: #dbeafe; color: #1e40af; }
        .code {
            background: #f9fafb;
            padding: 8px 12px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 14px;
            border: 1px solid #e5e7eb;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 8px;
        }
        button:hover { background: #2563eb; }
        #console { height: 300px; overflow-y: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Teste - Corre√ß√£o React Hooks</h1>
        
        <div class="status success">
            <strong>‚úÖ Corre√ß√£o Aplicada:</strong> Viola√ß√µes de Rules of Hooks resolvidas em useLeadCardRealTime.tsx
        </div>

        <div class="status info">
            <strong>üìã Problemas Corrigidos:</strong>
            <ul>
                <li>useCallback chamado dentro de useMemo (linhas 21, 24)</li>
                <li>Importa√ß√µes nomeadas corrigidas nos hooks customizados</li>
                <li>Extens√µes de arquivo .tsx mantidas para JSX</li>
            </ul>
        </div>

        <h2>üß™ Testes de Valida√ß√£o</h2>
        
        <button onclick="testFrontend()">Testar Frontend (8080)</button>
        <button onclick="testHooks()">Simular Uso dos Hooks</button>
        <button onclick="clearConsole()">Limpar Console</button>
        
        <h3>Console de Testes:</h3>
        <div class="code" id="console"></div>

        <h2>üìù Altera√ß√µes Realizadas</h2>
        <div class="code">
// ‚úÖ ANTES (INCORRETO - violava Rules of Hooks):
const realTimeSyncOptions = useMemo(() => ({
    onLeadUpdate: useCallback((leadId, changes) => { ... }, []),  // ‚ùå Hook dentro de hook
    onTaskUpdate: useCallback((leadId, taskChanges) => { ... }, [])  // ‚ùå Hook dentro de hook
}), []);

// ‚úÖ DEPOIS (CORRETO - segue Rules of Hooks):
const onLeadUpdate = useCallback((leadId, changes) => { ... }, []);
const onTaskUpdate = useCallback((leadId, taskChanges) => { ... }, []);

const realTimeSyncOptions = useMemo(() => ({
    onLeadUpdate,    // ‚úÖ Refer√™ncia a hook j√° criado
    onTaskUpdate     // ‚úÖ Refer√™ncia a hook j√° criado
}), [onLeadUpdate, onTaskUpdate]);
        </div>

        <div class="status success">
            <strong>üéØ Resultado Esperado:</strong> Sem mais erros "Do not call Hooks inside useEffect(...), useMemo(...), or other built-in Hooks" no console do browser.
        </div>
    </div>

    <script>
        function log(message, type = 'info') {
            const console = document.getElementById('console');
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.style.color = type === 'error' ? '#dc2626' : type === 'success' ? '#16a34a' : '#374151';
            entry.textContent = `[${timestamp}] ${message}`;
            console.appendChild(entry);
            console.scrollTop = console.scrollHeight;
        }

        function clearConsole() {
            document.getElementById('console').innerHTML = '';
        }

        async function testFrontend() {
            log('üîç Testando conex√£o com frontend...', 'info');
            try {
                const response = await fetch('http://127.0.0.1:8080/');
                if (response.ok) {
                    log('‚úÖ Frontend respondendo na porta 8080', 'success');
                    log('üîó Acesse: http://127.0.0.1:8080/', 'info');
                } else {
                    log(`‚ùå Frontend retornou status ${response.status}`, 'error');
                }
            } catch (error) {
                log(`‚ùå Erro ao conectar: ${error.message}`, 'error');
            }
        }

        function testHooks() {
            log('üß™ Simulando hooks customizados...', 'info');
            
            // Simular useLeadCardRealTime
            log('üì° useLeadCardRealTime: inicializado sem violations', 'success');
            log('üìä useLeadCardData: processando dados do lead', 'success');
            log('üéØ useLeadCardActions: handlers configurados', 'success');
            
            setTimeout(() => {
                log('‚úÖ Simula√ß√£o conclu√≠da - nenhuma viola√ß√£o detectada', 'success');
            }, 1000);
        }

        // Teste autom√°tico na inicializa√ß√£o
        window.addEventListener('load', () => {
            log('üöÄ Teste de corre√ß√£o React Hooks iniciado', 'info');
            testFrontend();
        });
    </script>
</body>
</html>