<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Debug Badge</title>
</head>
<body>
    <h1>ğŸ” Teste Debug Badge - Sistema de Logs</h1>
    <p><strong>Status:</strong> âœ… Logs implementados com sucesso!</p>
    
    <h2>ğŸ“‹ Logs Implementados:</h2>
    <ul>
        <li>âœ… <strong>Frontend (LeadCardPresentation):</strong> Log completo quando badge Ã© clicado</li>
        <li>âœ… <strong>Frontend (useCadenceActivityGenerator):</strong> Debug da requisiÃ§Ã£o e resposta</li>
        <li>âœ… <strong>Backend (cadence.ts):</strong> Debug completo do endpoint</li>
        <li>âœ… <strong>Backend (cadence.ts):</strong> Debug especÃ­fico do generateCumulativeTaskInstances</li>
    </ul>

    <h2>ğŸ¯ Como testar:</h2>
    <ol>
        <li>Acesse o CRM em <a href="http://127.0.0.1:8080" target="_blank">http://127.0.0.1:8080</a></li>
        <li>Abra o Console do navegador (F12)</li>
        <li>Encontre um card com badge "0/0" (como "testecarlos5")</li>
        <li>Clique no badge "0/0"</li>
        <li>Observe os logs no console:</li>
        <ul>
            <li><code>ğŸ¯ [DEBUG-BADGE-CARD]</code> - Dados do lead</li>
            <li><code>ğŸ” [DEBUG-BADGE-FRONTEND]</code> - RequisiÃ§Ã£o sendo enviada</li>
            <li><code>ğŸ“¨ [DEBUG-BADGE-FRONTEND]</code> - Resposta recebida</li>
        </ul>
        <li>Verifique logs do backend na sua sessÃ£o terminal</li>
    </ol>

    <h2>ğŸ” O que procurar nos logs:</h2>
    <ul>
        <li><strong>lead_master_id presente?</strong> Deve aparecer nos logs frontend</li>
        <li><strong>Request chegando no backend?</strong> Logs <code>[DEBUG-BADGE]</code></li>
        <li><strong>generateCumulativeTaskInstances sendo chamado?</strong> Log <code>ğŸš€</code></li>
        <li><strong>Resultado da geraÃ§Ã£o?</strong> Log <code>ğŸ“Š</code></li>
    </ul>

    <h2>ğŸ’¡ DiagnÃ³stico Esperado:</h2>
    <p>Com estes logs, devemos identificar exatamente onde o processo estÃ¡ falhando:</p>
    <ol>
        <li><strong>Se nÃ£o hÃ¡ logs frontend:</strong> Badge nÃ£o estÃ¡ sendo clicado ou funÃ§Ã£o nÃ£o executada</li>
        <li><strong>Se nÃ£o hÃ¡ logs backend:</strong> Request nÃ£o estÃ¡ chegando (problema de rede/auth)</li>
        <li><strong>Se logs param em generateCumulativeTaskInstances:</strong> Problema no CadenceService</li>
        <li><strong>Se tudo logado mas sem atividades criadas:</strong> Problema na configuraÃ§Ã£o ou dados</li>
    </ol>

    <hr>
    <p><strong>Status dos serviÃ§os:</strong></p>
    <p id="serviceStatus">Verificando...</p>

    <script>
        // Verificar status dos serviÃ§os
        async function checkServices() {
            const statusEl = document.getElementById('serviceStatus');
            
            try {
                // Verificar backend
                const backendResponse = await fetch('http://127.0.0.1:3001/health');
                const backendOk = backendResponse.ok;
                
                // Verificar frontend
                const frontendResponse = await fetch('http://127.0.0.1:8080/');
                const frontendOk = frontendResponse.ok;
                
                statusEl.innerHTML = `
                    Backend: ${backendOk ? 'âœ…' : 'âŒ'} (127.0.0.1:3001)<br>
                    Frontend: ${frontendOk ? 'âœ…' : 'âŒ'} (127.0.0.1:8080)<br>
                    <br>
                    ${backendOk && frontendOk ? 
                        'ğŸš€ <strong>Pronto para teste!</strong> Acesse o CRM e clique no badge.' : 
                        'âš ï¸ Alguns serviÃ§os estÃ£o offline. Verifique se ambos estÃ£o rodando.'
                    }
                `;
            } catch (error) {
                statusEl.innerHTML = `âŒ Erro ao verificar serviÃ§os: ${error.message}`;
            }
        }
        
        checkServices();
    </script>
</body>
</html>